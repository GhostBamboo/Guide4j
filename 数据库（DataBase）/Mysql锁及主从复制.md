## Mysql锁及主从复制

### 数据库锁

概念： 锁是计算机协调多个进程或线程并发访问某一资源的机制。在数据库中，除传统的计算机资源（如CPU、RAM、I/O等）的争用以外，数据也是一种供许多用户共享的资源。如何保证数据并发访问的一致性、有效性是所有数据库必须解决的一个问题，锁冲突也是影响数据库并发访问性能的一个重要因素。从这个角度来说，锁对数据库而言显得尤其重要，也更加复杂。

分类：

从对数据操作的类型（读|写）分：

- 读锁（共享锁）：针对同一份数据，多个读操作可以同时进行而不会互相影响。
- 写锁（排它锁）：当前写操作没有完成前，它会阻断其他写锁和读锁。

从对数据操作的粒度分：表锁和行锁。

### Mysql锁机制

分为表锁（偏读）、行锁（偏写）、页锁。

### 表锁（偏读）：

- 偏向MyISAM存储引擎，开销小，加锁快；
- 无死锁；
- 锁的粒度大，发生锁冲突的概率最高，并发度最低。

```sql
#查看表的上锁状态
show open tables like 'mylock';

#给表加读锁或写锁
LOCK table mylock read;
LOCK table mylock write;

#给表释放锁
unlock TABLES;
```

